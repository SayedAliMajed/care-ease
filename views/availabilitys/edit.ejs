<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Edit Availability</title>
   <link rel="stylesheet" href="/stylesheets/style.css">
</head>
<body>
  <%- include('../partials/_navbar.ejs') %>
  <main>
    <h2>Edit Availability</h2>
    <form action="/availabilitys/<%= availability._id %>?_method=PUT" method="POST">

      <div>
        <label for="date">Date:</label>
        <input type="date" id="date" name="date" value="<%= new Date(availability.date).toISOString().substring(0,10) %>" required />
      </div>

      <div>
        <label for="doctorId">Doctor:</label>
        <select name="doctorId" id="doctorId" required>
          <% doctors.forEach(doctor => { %>
            <option value="<%= doctor._id %>" <%= availability.doctorId && availability.doctorId.toString() === doctor._id.toString() ? 'selected' : '' %>>
              <%= doctor.profile.fullName %>
            </option>
          <% }) %>
        </select>
      </div>

      <div>
        <label for="openingTime">Opening Time:</label>
        <input type="time" id="openingTime" name="openingTime" value="<%= availability.openingTime %>" required />
      </div>

      <div>
        <label for="closingTime">Closing Time:</label>
        <input type="time" id="closingTime" name="closingTime" value="<%= availability.closingTime %>" required />
      </div>

      <div>
        <label for="duration">Slot Duration (minutes):</label>
        <input type="number" id="duration" name="duration" min="1" value="<%= availability.duration %>" required />
      </div>

      <div>
        <label>Break Time:</label>
        <div>
          <label for="breakStartTime">Start:</label>
          <input type="time" id="breakStartTime" name="breakStartTime" value="<%= availability.breakTimes && availability.breakTimes[0] ? availability.breakTimes[0].startTime : '' %>" />
          <label for="breakEndTime">End:</label>
          <input type="time" id="breakEndTime" name="breakEndTime" value="<%= availability.breakTimes && availability.breakTimes[0] ? availability.breakTimes[0].endTime : '' %>" />
        </div>
      </div>

      <div>
        <label for="isRepeating">Repeat Daily:</label>
        <input type="checkbox" id="isRepeating" name="isRepeating" <%= availability.isRepeating ? 'checked' : '' %> />
      </div>

      <button type="submit">Save Changes</button>
    </form>
    <a href="/availabilitys">Back to List</a>
  </main>
</body>
</html>